<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WIP Tracker</title>
<style>
  body { font-family: system-ui, sans-serif; background:#f9fafb; padding:20px; }
  h1 { margin-bottom: 20px; }
  table { border-collapse: collapse; width:100%; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,.1); }
  th, td { border:1px solid #ddd; padding:8px; text-align:center; }
  th { background:#f3f4f6; }
  tfoot td { font-weight:bold; background:#f9fafb; }
  input { width:100%; border:none; padding:4px; text-align:center; }
  input:focus { outline:1px solid #3b82f6; }
  .btn { margin-top:12px; padding:10px 14px; border:none; border-radius:8px; background:#3b82f6; color:#fff; cursor:pointer; }
</style>
</head>
<body>

<h1>WIP Tracker</h1>

<table id="wipTable">
  <thead>
    <tr>
      <th>#</th>
      <th>Description</th>
      <th>WIP Balance</th>
      <th>Interim</th>
      <th>Fee</th>
      <th>Write-up/off</th>
      <th>Carry Fwd/Transfer</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody id="rows">
    <tr>
      <td>1</td>
      <td><input value="Brumflo Group Tax Advisory"></td>
      <td><input type="number" value="170"></td>
      <td><input type="number" value="170"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input type="number" value="170"></td>
      <td><input value="BELAIDI Abhijeet"></td>
    </tr>
    <tr>
      <td>2</td>
      <td><input value="Kirk Family Tax Advisory"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input value="WANG Joey"></td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td colspan="2">Total</td>
      <td id="totWip">0</td>
      <td id="totInterim">0</td>
      <td id="totFee">0</td>
      <td id="totWrite">0</td>
      <td id="totCarry">0</td>
      <td></td>
    </tr>
    <tr>
      <td colspan="2">Tech & Admin Levy</td>
      <td colspan="6" id="levy">0</td>
    </tr>
  </tfoot>
</table>

<button class="btn" onclick="addRow()">+ Add Row</button>
<button class="btn" onclick="downloadCSV()">â¬‡ Export CSV</button>

<script>
function recalc() {
  let totW=0, totI=0, totF=0, totWr=0, totC=0;
  document.querySelectorAll("#rows tr").forEach(tr=>{
    const vals=[...tr.querySelectorAll("td input")].map(i=>parseFloat(i.value)||0);
    totW+=vals[1]; totI+=vals[2]; totF+=vals[3]; totWr+=vals[4]; totC+=vals[5];
  });
  document.getElementById("totWip").textContent=totW;
  document.getElementById("totInterim").textContent=totI;
  document.getElementById("totFee").textContent=totF;
  document.getElementById("totWrite").textContent=totWr;
  document.getElementById("totCarry").textContent=totC;
  document.getElementById("levy").textContent=(totF*0.04).toFixed(1); // example 4% levy
}
document.addEventListener("input", recalc);
recalc();

function addRow() {
  const tbody=document.getElementById("rows");
  const idx=tbody.children.length+1;
  const tr=document.createElement("tr");
  tr.innerHTML=`<td>${idx}</td><td><input></td>
  <td><input type="number"></td><td><input type="number"></td>
  <td><input type="number"></td><td><input type="number"></td>
  <td><input type="number"></td><td><input></td>`;
  tbody.appendChild(tr);
}

function downloadCSV() {
  const rows=[["#","Description","WIP Balance","Interim","Fee","Write-up/off","CarryFwd","Name"]];
  document.querySelectorAll("#rows tr").forEach(tr=>{
    rows.push([...tr.querySelectorAll("td input")].map(i=>i.value));
  });
  let csv=rows.map(r=>r.join(",")).join("\n");
  const blob=new Blob([csv],{type:"text/csv"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="wip_export.csv";
  a.click();
}
</script>

</body>
</html>
